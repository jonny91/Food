C51 COMPILER V9.52.0.0   MAIN                                                              11/17/2017 14:12:00 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN Main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Main.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <STC12C5A60S2.H>
   2          #include "BackRoom.h"
   3          #include "Board.h"
   4          #include "uart.h"
   5          #include "mp3.h"
   6          
   7          sbit INPUT_DOOR_00 = P0^0;
   8          sbit INPUT_HEAVY_01 = P0^1;
   9          sbit OUTPUT_LOCK_02 = P0^2;//第一个电磁锁
  10          //对应摆放3个
  11          sbit INPUT_PUT_03 = P0^3;
  12          sbit INPUT_PUT_04 = P0^4;
  13          sbit INPUT_PUT_05 = P0^5;
  14          
  15          sbit OUTPUT_LOCK_06 = P0^6;//第二个电磁锁
  16          sbit INPUT_AIRBELLOW_07 = P0^7;//拉风箱输入
  17          
  18          
  19          void Start();
  20          void CheckHeavy();
  21          void Put3();
  22          void CheckClose();
  23          void AirBellow();
  24          
  25          void Init()
  26          {
  27   1        INPUT_DOOR_00 = 0;
  28   1        INPUT_HEAVY_01 = 0;
  29   1        OUTPUT_LOCK_02 = 1;
  30   1        INPUT_PUT_03 = 0;
  31   1        INPUT_PUT_04 = 0;
  32   1        INPUT_PUT_05 = 0;
  33   1        OUTPUT_LOCK_06 = 1;
  34   1        INPUT_AIRBELLOW_07 = 0;
  35   1      }
  36          
  37          void main()
  38          {
  39   1        Init();
  40   1        uart_init();
  41   1        mp3_init();
  42   1      
  43   1        delay_ms(100);  
  44   1        
  45   1        while(1)
  46   1        {
  47   2          switch(step)
  48   2          {
  49   3            case 0:
  50   3              Start(); //关门开始
  51   3              break;
  52   3            case 1:
  53   3              CheckHeavy();//称重
  54   3              break;
  55   3            case 2:
C51 COMPILER V9.52.0.0   MAIN                                                              11/17/2017 14:12:00 PAGE 2   

  56   3              Put3(); //对应摆放3个
  57   3              break;
  58   3            case 4:
  59   3              CheckClose(); //检查上面两个柜门是不是关闭
  60   3              break;
  61   3            case 5:
  62   3              AirBellow();//拉风箱
  63   3              break;
  64   3          }
  65   2        }
  66   1      }
  67          
  68          void Start()
  69          {
  70   1        if(INPUT_DOOR_00 == 1)
  71   1        {
  72   2          delay_ms(8000);
  73   2          setStep(1);   
  74   2        }
  75   1      }
  76          
  77          void CheckHeavy()
  78          {
  79   1        if(INPUT_HEAVY_01 == 1)
  80   1        {
  81   2          delay_ms(50);
  82   2          if(INPUT_HEAVY_01 == 1) //称重
  83   2          {
  84   3            OUTPUT_LOCK_02 = 0;//打开电磁锁
  85   3            setStep(2);
  86   3          }
  87   2        }
  88   1      }
  89          
  90          void Put3()
  91          {
  92   1        if((INPUT_PUT_03 == 1)&&(INPUT_PUT_04 == 1)&&(INPUT_PUT_05 == 1))
  93   1        {
  94   2          delay_ms(50);
  95   2          if((INPUT_PUT_03 == 1)&&(INPUT_PUT_04 == 1)&&(INPUT_PUT_05 == 1))
  96   2          {
  97   3            OUTPUT_LOCK_06 = 0;//第二个电磁锁断电
  98   3            setStep(3);
  99   3          }
 100   2        }
 101   1      }
 102          
 103          void CheckClose()
 104          {
 105   1        if((OUTPUT_LOCK_02 == 1)&&(OUTPUT_LOCK_06 == 1))
 106   1        {
 107   2          delay_ms(50);
 108   2          if((OUTPUT_LOCK_02 == 1)&&(OUTPUT_LOCK_06 == 1))
 109   2          {
 110   3            Switch_Fan = 1;
 111   3            setStep(4);
 112   3          }
 113   2        }
 114   1      }
 115          
 116          void AirBellow()
 117          {
C51 COMPILER V9.52.0.0   MAIN                                                              11/17/2017 14:12:00 PAGE 3   

 118   1        
 119   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    562    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
